<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Bitcoin Macro Dashboard</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
            background: linear-gradient(145deg, #0d0d0d 0%, #1a1a2e 50%, #0d0d0d 100%);
            min-height: 100vh;
            color: #fff;
            padding: 15px;
        }
        
        .container { max-width: 600px; margin: 0 auto; }
        
        h1 {
            text-align: center;
            font-size: 1.6em;
            margin-bottom: 5px;
            background: linear-gradient(90deg, #f7931a, #ffab40);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            font-size: 0.8em;
            margin-bottom: 20px;
        }
        
        .card {
            background: rgba(255,255,255,0.04);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid rgba(255,255,255,0.08);
        }
        
        .card-title {
            font-size: 0.75em;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            margin-bottom: 12px;
        }
        
        .price-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .price-label { color: #aaa; font-size: 0.9em; }
        
        .price-value {
            font-size: 1.3em;
            font-weight: 600;
        }
        
        .btc { color: #f7931a; }
        .gold { color: #ffd700; }
        .ratio { color: #4ade80; }
        .neutral { color: #fff; }
        .liquidity { color: #60a5fa; }
        
        .highlight-card {
            background: linear-gradient(135deg, rgba(247,147,26,0.15) 0%, rgba(247,147,26,0.05) 100%);
            border-color: rgba(247,147,26,0.3);
            text-align: center;
            padding: 25px;
        }
        
        .big-number {
            font-size: 3em;
            font-weight: 700;
            color: #f7931a;
        }
        
        .big-label {
            font-size: 0.85em;
            color: #aaa;
            margin-top: 5px;
        }
        
        .change {
            font-size: 0.8em;
            padding: 3px 8px;
            border-radius: 8px;
            margin-left: 8px;
        }
        
        .change.up { background: rgba(74,222,128,0.2); color: #4ade80; }
        .change.down { background: rgba(239,68,68,0.2); color: #ef4444; }
        
        .mini-chart {
            height: 60px;
            background: rgba(255,255,255,0.03);
            border-radius: 8px;
            margin-top: 15px;
            display: flex;
            align-items: flex-end;
            padding: 5px;
            gap: 2px;
        }
        
        .bar {
            flex: 1;
            background: linear-gradient(to top, #f7931a, #ffab40);
            border-radius: 2px 2px 0 0;
            min-height: 5px;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .metric-box {
            background: rgba(255,255,255,0.03);
            padding: 12px;
            border-radius: 10px;
            text-align: center;
        }
        
        .metric-value {
            font-size: 1.2em;
            font-weight: 600;
            color: #fff;
        }
        
        .metric-label {
            font-size: 0.7em;
            color: #888;
            margin-top: 4px;
        }
        
        .power-law-gauge {
            height: 8px;
            background: linear-gradient(90deg, #22c55e 0%, #eab308 50%, #ef4444 100%);
            border-radius: 4px;
            margin: 15px 0;
            position: relative;
        }
        
        .gauge-marker {
            position: absolute;
            top: -4px;
            width: 16px;
            height: 16px;
            background: #fff;
            border-radius: 50%;
            transform: translateX(-50%);
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }
        
        .gauge-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.65em;
            color: #666;
        }
        
        .section-divider {
            height: 1px;
            background: rgba(255,255,255,0.1);
            margin: 20px 0;
        }
        
        .info-text {
            font-size: 0.75em;
            color: #666;
            text-align: center;
            margin-top: 15px;
            line-height: 1.4;
        }
        
        .update-time {
            text-align: center;
            font-size: 0.7em;
            color: #444;
            margin-top: 20px;
        }
        
        .nav-links {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .nav-links a {
            color: #888;
            text-decoration: none;
            font-size: 0.8em;
            padding: 5px 12px;
            border-radius: 15px;
            background: rgba(255,255,255,0.05);
        }
        
        .nav-links a.active {
            color: #f7931a;
            background: rgba(247,147,26,0.15);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>â‚¿ Macro Dashboard</h1>
        <p class="subtitle">Bitcoin â€¢ Gold â€¢ Liquidity</p>
        
        <div class="nav-links">
            <a href="index.html">Power Law</a>
            <a href="energy-metrics.html">Energy</a>
            <a href="macro.html" class="active">Macro</a>
        </div>
        
        <!-- BTC/Gold Ratio Card -->
        <div class="card highlight-card">
            <div class="card-title">â‚¿ Bitcoin / Gold Ratio</div>
            <div class="big-number" id="btc-gold-ratio">--</div>
            <div class="big-label">ounces of gold per BTC</div>
        </div>
        
        <!-- Price Comparison -->
        <div class="card">
            <div class="card-title">ðŸ’° Current Prices</div>
            <div class="price-row">
                <span class="price-label">Bitcoin (BTC)</span>
                <span class="price-value btc" id="btc-price">$--</span>
            </div>
            <div class="price-row">
                <span class="price-label">Gold (XAU/oz)</span>
                <span class="price-value gold" id="gold-price">$--</span>
            </div>
            <div class="price-row">
                <span class="price-label">Silver (XAG/oz)</span>
                <span class="price-value neutral" id="silver-price">$--</span>
            </div>
            
            <div class="section-divider"></div>
            
            <div class="metrics-grid">
                <div class="metric-box">
                    <div class="metric-value" id="btc-oz-ratio">--</div>
                    <div class="metric-label">BTC in Gold oz</div>
                </div>
                <div class="metric-box">
                    <div class="metric-value" id="btc-silver-ratio">--</div>
                    <div class="metric-label">BTC in Silver oz</div>
                </div>
            </div>
        </div>
        
        <!-- Power Law Position (mini) -->
        <div class="card">
            <div class="card-title">ðŸ“Š Power Law Position</div>
            <div class="price-row">
                <span class="price-label">Fair Value</span>
                <span class="price-value neutral" id="fair-value">$--</span>
            </div>
            <div class="price-row">
                <span class="price-label">Current vs Fair</span>
                <span class="price-value" id="fair-diff">--%</span>
            </div>
            <div class="power-law-gauge">
                <div class="gauge-marker" id="pl-marker" style="left: 50%;"></div>
            </div>
            <div class="gauge-labels">
                <span>Undervalued</span>
                <span>Fair</span>
                <span>Overvalued</span>
            </div>
        </div>
        
        <!-- Global Liquidity Placeholder -->
        <div class="card">
            <div class="card-title">ðŸŒŠ Global Liquidity (M2)</div>
            <div class="price-row">
                <span class="price-label">Global M2 (4 Major CBs)</span>
                <span class="price-value liquidity">~$90T</span>
            </div>
            <div class="price-row">
                <span class="price-label">YoY Change</span>
                <span class="price-value liquidity">+4.2%</span>
            </div>
            <div class="info-text">
                ðŸ’¡ Bitcoin historically correlates with global M2 expansion.
                When central banks print, hard assets rise.
            </div>
        </div>
        
        <!-- Market Context -->
        <div class="card">
            <div class="card-title">ðŸ“ˆ Market Context</div>
            <div class="metrics-grid">
                <div class="metric-box">
                    <div class="metric-value" id="gold-btc-mcap">--</div>
                    <div class="metric-label">Gold vs BTC MCap</div>
                </div>
                <div class="metric-box">
                    <div class="metric-value" id="btc-dominance">--</div>
                    <div class="metric-label">BTC Dominance</div>
                </div>
            </div>
            <div class="info-text" style="margin-top: 12px;">
                Gold market cap: ~$17T | BTC market cap: ~$1.7T<br>
                BTC = ~10% of gold. Room to grow? ðŸš€
            </div>
        </div>
        
        <div class="update-time" id="update-time">Loading...</div>
    </div>
    
    <script>
        // Power Law calculation (same as main app)
        function getPowerLawFairValue() {
            const genesisDate = new Date('2009-01-03');
            const today = new Date();
            const daysSinceGenesis = Math.floor((today - genesisDate) / (1000 * 60 * 60 * 24));
            // Power Law: price = 10^(a + b * log10(days))
            const a = -17.01;
            const b = 5.82;
            return Math.pow(10, a + b * Math.log10(daysSinceGenesis));
        }
        
        async function fetchData() {
            try {
                // Fetch BTC price
                const btcRes = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd&include_market_cap=true');
                const btcData = await btcRes.json();
                const btcPrice = btcData.bitcoin.usd;
                const btcMcap = btcData.bitcoin.usd_market_cap;
                
                // Fetch Gold price
                const goldRes = await fetch('https://data-asg.goldprice.org/dbXRates/USD');
                const goldData = await goldRes.json();
                const goldPrice = goldData.items[0].xauPrice;
                const silverPrice = goldData.items[0].xagPrice;
                
                // Calculate ratios
                const btcGoldRatio = btcPrice / goldPrice;
                const btcSilverRatio = btcPrice / silverPrice;
                
                // Power Law
                const fairValue = getPowerLawFairValue();
                const fairDiff = ((btcPrice - fairValue) / fairValue) * 100;
                
                // Update DOM
                document.getElementById('btc-price').textContent = '$' + btcPrice.toLocaleString(undefined, {maximumFractionDigits: 0});
                document.getElementById('gold-price').textContent = '$' + goldPrice.toLocaleString(undefined, {maximumFractionDigits: 2});
                document.getElementById('silver-price').textContent = '$' + silverPrice.toLocaleString(undefined, {maximumFractionDigits: 2});
                
                document.getElementById('btc-gold-ratio').textContent = btcGoldRatio.toFixed(1);
                document.getElementById('btc-oz-ratio').textContent = btcGoldRatio.toFixed(1) + ' oz';
                document.getElementById('btc-silver-ratio').textContent = btcSilverRatio.toFixed(0) + ' oz';
                
                document.getElementById('fair-value').textContent = '$' + fairValue.toLocaleString(undefined, {maximumFractionDigits: 0});
                
                const fairDiffEl = document.getElementById('fair-diff');
                fairDiffEl.textContent = (fairDiff >= 0 ? '+' : '') + fairDiff.toFixed(1) + '%';
                fairDiffEl.style.color = fairDiff >= 0 ? '#4ade80' : '#ef4444';
                
                // Position gauge marker (0-100%, with 50% being fair value)
                // Map -50% to +100% range to 0-100% position
                const markerPos = Math.max(0, Math.min(100, 50 + (fairDiff / 2)));
                document.getElementById('pl-marker').style.left = markerPos + '%';
                
                // Market context
                const goldMcap = 17; // trillion
                const btcMcapT = btcMcap / 1e12;
                document.getElementById('gold-btc-mcap').textContent = (goldMcap / btcMcapT).toFixed(1) + 'x';
                document.getElementById('btc-dominance').textContent = '~55%';
                
                document.getElementById('update-time').textContent = 'Updated: ' + new Date().toLocaleTimeString();
                
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('update-time').textContent = 'Error loading data';
            }
        }
        
        // Initial load
        fetchData();
        
        // Refresh every 2 minutes
        setInterval(fetchData, 2 * 60 * 1000);
    </script>
</body>
</html>
